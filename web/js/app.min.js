let Domain=document.querySelector('meta[name="user-url"]').getAttribute("content");function getdata(e,t,r=function(){}){let n=new XMLHttpRequest;n.open("POST",e,!0),n.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),n.send(JSON.stringify(t)),n.onreadystatechange=function(){4==n.readyState&&(ans=JSON.parse(n.responseText),console.log(ans),r(ans))}}document.querySelectorAll(".unical-form").forEach(e=>{e.addEventListener("submit",t=>{t.preventDefault(),t.stopImmediatePropagation;let r={};e.querySelectorAll("input").forEach(e=>{r[e.name]=e.value}),e.querySelector("button").classList.add("hidden"),e.querySelector("input").setAttribute("disabled",!0);let n=document.querySelector(".unical-result");return getdata(e.dataset.method,r,e=>{1===e.status?(n.classList.add("active"),n.querySelector("a").innerHTML=Domain+"/"+e.data.alias,n.querySelector("a").setAttribute("href",Domain+"/"+e.data.alias)):(n.classList.add("error"),n.querySelector("p").innerHTML=e.error.message)}),!1})}),document.querySelectorAll("*[data-copy]").forEach(e=>{e.addEventListener("click",()=>{console.log(e.dataset.copy);let t=document.querySelector(e.dataset.copy);if(console.log(t),t){var r,n;(r=document.createRange()).selectNode(t),(n=window.getSelection()).removeAllRanges,n.addRange(r),document.execCommand("copy");let a=e.innerHTML;e.innerHTML="Скопированно",e.classList.add("success-copy"),setTimeout(()=>{e.innerHTML=a,e.classList.remove("success-copy")},3e3)}})}),document.querySelectorAll(".js-newlink").forEach(e=>{e.addEventListener("click",()=>{let e=document.querySelector(".unical-result");e.classList.remove("active"),e.classList.remove("error"),e.querySelector("a").innerHTML="",e.querySelector("a").setAttribute("href",""),e.querySelector("p").innerHTML="",document.querySelector(".unical-form button").classList.remove("hidden"),document.querySelector(".unical-form input").removeAttribute("disabled")})});